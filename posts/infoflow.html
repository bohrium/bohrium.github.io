<html>
    <head>
        <link rel="stylesheet" type="text/css" href="../css/moo.css" />
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
            });
        </script>
        <script type="text/javascript"
            src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>
    </head>
    <body>
        <h1><a href="../index.html" style="color:rgb(0, 0, 64);">Samuel Tenka</a></h1>

        
<p>
$\newcommand{\from}{\leftarrow}$
$\newcommand{\CC}{\mathbb{C}}$
$\newcommand{\RR}{\mathbb{R}}$
$\newcommand{\Con}{\texttt{Con}}$
$\newcommand{\Vec}{\texttt{Vec}}$
$\newcommand{\Set}{\texttt{Set}}$
<p>
<h2>  Info Flow in the Category of Conditionals  </h2>
<h5>  by Sam Tenka </h5>
<p>
<h4>  Introduction </h4>
<p>
Let $\Con$ be the category whose objects are sets and whose morphisms to $A$ from $B$ are the
conditional distributions of form $P(a|b)$.  We may represent each such distribution as a
<b>stochastic matrix</b> whose rows are indexed by $A$ and whose columns are indexed by $B$.  The word
"matrix" just means an array of real numbers such that each column contains only finitely many
non-zero entries.  The word "stochastic" just means that all entries are non-negative and that each
column sums to $1$.  Then composition of morphisms is given by matrix multiplication in the usual
way: $P(a|c) = \sum_b P(a|b) P(b|c)$. 
<p>
At first glance, $\Con$ seems akin to the category $\Vec$ of real vector spaces.
However, because the stochasticity condition is so strong, the two categories turn out to be very
different.  For instance, many stochastic matrices are invertible in $\Vec$ but not in $\Con$:
$$ \left( \matrix{1 & 1/2 \\ 0 & 1/2} \right)^{-1} = \left( \matrix{1 & -1/2 \\ 0 & 2} \right) $$
As we will see, the stochasticity condition allows us to recover which morphisms are deterministic,
a concept that has no analogue in the basis-invariant constructions of $\Vec$.
<p>
In fact, my attempts to model $\Con$ in terms of a modified $\Vec$ --- for example by considering
pointed vector spaces --- all failed.  Instead, $\Con$ seems to interpolate between $\Vec$ and
$\Set$.  For instance, $\Set$ embeds into $\Con$ and $\Con$ embeds into $\Vec$ via the obvious
functors $L_{CS}, E_{VC}$ (by "embed", we mean "injective on objects and on homsets").  Moreover,
we may define a forgetful functor $R_{SC}: \Set \from \Con$ that sends each set to the real simplex
it generates and each stochastic matrix to the corresponding set map between simplices.  Then 
$L_{CS}$ and $R_{SC}$ are adjoint in the usual free/forgetful way:
$$Hom_{\Con}(C \from L_{CS}(S)) \cong Hom_{\Set}(R_{SC}(C) \from S)$$
By contrast, $E_{VC}$ is neither a free-type nor a forgetful-type adjoint: we will see
below that it preserves neither colimits nor limits.
<p>
<h4>  $\Con$ has Colimits </h4>
As with $\Set$, $\Con$ has an initial element (the empty set $0$) and a terminal element (the
singleton $1$).  These are the nullary product and nullary coproduct, respectively.  Maps <em>from</em>
the terminal element $1$ are not in general unique; they are <em>elements</em> in $\Set$ and
<em>distributions</em> in $\Con$.    
<p>
Finitary coproducts exist, too!  Let $A, B$ be objects.  Then, since $L_{CS}$ is a free-type
adjoint, if $A, B$ have a coproduct in $\Con$, it is induced by the coproduct in $\Set$.  Let us
check that this is indeed a colimit.  Call the canonical inclusions $a, b$.  Then if
$\alpha, \beta$ map to $A, B$ from some test object $P$, we must demonstrate a unique conditional
$m:P\from A\sqcup B$ that commutes (i.e. $ma=\alpha$ and $mb=\beta$).  Well, writing $\alpha$ and
$\beta$ as matrices, it is clear that $m = (\matrix{\alpha & \beta})$ works and is unique.  When we
pre-compose any $p:C\from A\sqcup B$ by $a:A\sqcup B\from A$, we get $pa:C \from A$.  This is
<b>[co]nditioning</b>!
<p>
Moreover, there are finitary coequalizers.  To see this, we establish a lemma.  In what follows,
call a subset $S\subseteq \RR^n$ an <b>$n$-simplex</b> if it is the convex hull of a unique set of $n$
points, which we call its <em>generators</em>.  In this case, the <b>rank</b> of $s\in S$ is the size of a
smallest set of generators whose convex hull contains $s$.  The rank-$n$ points of $S$ are <b>generic</b>. 
<p>
<b>Lemma</b>: If $S\subseteq \RR^n$ is an $n$-simplex, $W\subseteq \RR^n$ is a subspace
of dimension $m$, and $W$ meets $S$ at a generic point, then $W\cap S$ is an $m$-simplex.
<p>
<b>Proof</b>: The simplices that are subsets of $W\cap S$ form a poset $\mathcal{P}$ by inclusion. 
<p>
<h4>  Limits give Independence!  </h4>
Unfortunately, finitary products don't generally exist.  
<p>
Let us therefore freely adjoin all limits by taking $\Con$'s completion
$\Con^\star = (\Set^{\Con})^{op}$.  For instance, $\Con^\star$ contains the product $A\cdot B$
of objects $A, B$ in $\Con$.  We see that a map into $A\cdot B$ carries the same data
as a pair of maps into $A, B$.  Thus, maps to $A\cdot B$ from $C$ represent <b>independent</b> joint
distributions $p(a,b|c) = p(a|c)p(b|c)$!
<p>
If $A, B$ are objects, we may consider their cartesian product $A\times B$ along with the canonical 
projections $a, b$.  If $\alpha, \beta$ map to some For any test object $P$ that maps via $\alpha, \beta$ to $A, B$, there exists
a conditional $m:A\times B\from P$ This cartesian product is not a categorical product because its "universal arrows"
are not actually unique.  Still, when we post-compose by $a:A\from A\times B$ any $p:A\times B\from C$,
we get $ap:A\from C$.  This is is <b>marginalization</b>!
<p>
We say that two distributions $a:A\from 1$ and $b:B\from 1$
<p>
<h4>  Determinism </h4>
Can we tell from within $\Con$ which morphisms lie in the image of the free functor $F_{CS}$?  Call
such morphisms <b>deterministic</b>.  Then left-invertible morphisms correspond to injective functions
and right-invertible morphisms correspond to surjective functions.  It follows that the
deterministic morphisms are precisely those of form $i\circ s$, where $i$ is left-invertible and
$s$ in right-invertible. 
<p>
    </body>
</html>
